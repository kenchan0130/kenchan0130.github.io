<!DOCTYPE html> <html> <!-- This page is used centrarium Jekyll theme Copyright (c) 2015 Ben Centra Released under the MIT license https://github.com/bencentra/centrarium/blob/daa0d16ba9156ad43f9980e2075023a0d48859a5/LICENSE.md --> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"> <title>Google Apps Scriptのモダンな開発環境は理想だった</title> <meta name="description" content="ちょうど1年前、「Google Apps Scriptのモダンな開発環境を求めて」という記事を書きました。 これにより、モダンな開発環境によってDeveloper Experienceが高いGASプロジェクト開発ができたかというと、残念ながらそうではありません。 実際に運用していくうちに、いつくか課題が見えてきました。 今回はそれらの課題と向き合いどのように対応したかを紹介します。"> <meta name="author" content="Tadayuki Onishi"> <meta name="copyright" content="© Tadayuki Onishi 2025"> <link rel="shortcut icon" href="/assets/icons/favicon.ico" type="image/x-icon"> <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon"> <link rel="apple-touch-icon" sizes="57x57" href="/assets/icons/apple-icon-57x57.png"> <link rel="apple-touch-icon" sizes="60x60" href="/assets/icons/apple-icon-60x60.png"> <link rel="apple-touch-icon" sizes="72x72" href="/assets/icons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="76x76" href="/assets/icons/apple-icon-76x76.png"> <link rel="apple-touch-icon" sizes="114x114" href="/assets/icons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="120x120" href="/assets/icons/apple-icon-120x120.png"> <link rel="apple-touch-icon" sizes="144x144" href="/assets/icons/apple-icon-144x144.png"> <link rel="apple-touch-icon" sizes="152x152" href="/assets/icons/apple-icon-152x152.png"> <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-icon-180x180.png"> <link rel="icon" type="image/png" sizes="192x192" href="/assets/icons/android-icon-192x192.png"> <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon-32x32.png"> <link rel="icon" type="image/png" sizes="96x96" href="/assets/icons/favicon-96x96.png"> <link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon-16x16.png"> <link rel="manifest" href="/assets/icons/manifest.json"> <meta name="msapplication-TileColor" content="#ffffff"> <meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144x144.png"> <meta name="theme-color" content="#ffffff"> <meta property="fb:app_id" content="376889769419405"> <meta property="og:description" content="ちょうど1年前、「Google Apps Scriptのモダンな開発環境を求めて」という記事を書きました。 これにより、モダンな開発環境によってDeveloper Experienceが高いGASプロジェクト開発ができたかというと、残念ながらそうではありません。 実際に運用していくうちに、いつくか課題が見えてきました。 今回はそれらの課題と向き合いどのように対応したかを紹介します。"> <meta property="og:url" content="https://kenchan0130.github.io/post/2019-12-25-1"> <meta property="og:site_name" content="kenchan0130 blog"> <meta property="og:title" content="Google Apps Scriptのモダンな開発環境は理想だった"> <meta property="og:type" content="website"> <meta property="og:author" content="Tadayuki Onishi"> <meta property="og:image" content="https://kenchan0130.github.io/assets/logo.png"> <meta property="og:image:width" content="760"> <meta property="og:image:height" content="760"> <meta property="og:image:type" content="image/png"> <meta name="twitter:card" content="summary"> <meta name="twitter:title" content="Google Apps Scriptのモダンな開発環境は理想だった"> <meta name="twitter:site" content="@kenchan0130"> <meta name="twitter:description" content="ちょうど1年前、「Google Apps Scriptのモダンな開発環境を求めて」という記事を書きました。 これにより、モダンな開発環境によってDeveloper Experienceが高いGASプロジェクト開発ができたかというと、残念ながらそうではありません。 実際に運用していくうちに、いつくか課題が見えてきました。 今回はそれらの課題と向き合いどのように対応したかを紹介します。"> <meta name="twitter:image" content="https://kenchan0130.github.io/assets/logo.png"> <meta name="twitter:url" content="https://kenchan0130.github.io/post/2019-12-25-1"> <link rel="preload" as="style" href="/assets/bundle/app.55445db2fff8ddfed8c5.css" onload="this.onload=null;this.rel='stylesheet'"> <noscript> <link rel="stylesheet" href="/assets/bundle/app.55445db2fff8ddfed8c5.css"> </noscript> <link rel="stylesheet" href="/css/main.css"> <link rel="canonical" href="https://kenchan0130.github.io/post/2019-12-25-1"> <link rel="alternate" type="application/atom+xml" title="kenchan0130 blog" href="https://kenchan0130.github.io/feed.xml"> <meta name="google-site-verification" content="ZxlKORgZZwZ4TTmaQJFFEXLF3jmd6P_NVU9TEVW1bSg"> <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> </head> <body> <header class="navigation" role="banner"> <div class="navigation-wrapper"> <a href="/" class="logo"> <img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="kenchan0130 blog" data-src="/assets/logo.png" class="lazyload"> </a> <a href="javascript:void(0)" class="navigation-menu-button" id="js-mobile-menu"> <i class="fas fa-bars"></i> </a> <nav role="navigation"> <ul id="js-navigation-menu" class="navigation-menu"> <li class="nav-search-box"> <div class="search-input-container"> <input type="search" class="search-input" id="js-search-input" placeholder="Search" autocomplete="off" onfocus="gtag('event', 'search', { event_category: 'www.algolia.com/apps/DEFR5IK9E2/explorer/browse/kenchan0130_blog', event_label: '/post/2019-12-25-1' });"> <i class="fa fa-search search-input-icon"></i> <template id="suggestion-template"> <a href="" onclick="gtag('event', 'click', { event_category: 'www.algolia.com/apps/DEFR5IK9E2/explorer/browse/kenchan0130_blog', event_label: this.href });"> <p class="suggestion-title js-suggestion-title"></p> <p class="suggestion-content js-suggestion-content"></p> </a> </template> </div> </li> <li class="nav-link"> <a href="/archives">Archives</a> </li> <li class="nav-link"> <a href="/profile">Profile</a> </li> </ul> </nav> </div> </header> <div class="page-content"> <div class="post"> <div class="post-header-container "> <div class="scrim "> <header class="post-header"> <h1 class="title">Google Apps Scriptのモダンな開発環境は理想だった</h1> </header> </div> </div> <div class="wrapper"> <span class="page-divider"> <span class="one"></span> <span class="two"></span> </span> <section class="post-meta"> <div class="post-date">2019-12-25</div> <div class="post-categories"> <i class="fas fa-fw fa-book"></i> <a href="/category/development">development </a> </div> </section> <article class="post-content"> <p>ちょうど1年前、「<a href="/post/2018-12-03-1">Google Apps Scriptのモダンな開発環境を求めて</a>」という記事を書きました。 これにより、モダンな開発環境によってDeveloper Experienceが高いGASプロジェクト開発ができたかというと、残念ながらそうではありませんでした。 実際に運用していくうちに、いつくか課題が見えてきました。</p> <p>今回はそれらの課題と向き合いどのように対応したのかを紹介します。</p> <p>この記事は<a href="https://qiita.com/advent-calendar/2019/folio-sec" target="_blank" rel="noopener noreferrer">FOLIO Advent Calendar 2019</a>の12月25日の記事でもあります。</p> <ul id="markdown-toc"> <li><a href="#%E5%89%8D%E5%9B%9E%E3%81%AE%E3%81%8A%E3%81%95%E3%82%89%E3%81%84" id="markdown-toc-前回のおさらい">前回のおさらい</a></li> <li> <a href="#%E8%A6%8B%E3%81%88%E3%81%A6%E3%81%8D%E3%81%9F%E8%AA%B2%E9%A1%8C" id="markdown-toc-見えてきた課題">見えてきた課題</a> <ul> <li><a href="#npm%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%81%8C%E7%A8%AE%E9%A1%9E%E3%81%AB%E3%82%88%E3%81%A3%E3%81%A6gas%E3%81%A7%E3%81%AF%E5%8B%95%E3%81%8B%E3%81%AA%E3%81%84%E5%95%8F%E9%A1%8C" id="markdown-toc-npmライブラリが種類によってgasでは動かない問題">npmライブラリが種類によってGASでは動かない問題</a></li> <li><a href="#polyfill%E3%81%8C%E5%B7%A8%E5%A4%A7%E3%81%99%E3%81%8E%E3%81%A6%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E3%82%A8%E3%83%87%E3%82%A3%E3%82%BF%E9%96%8B%E3%81%8B%E3%81%AA%E3%81%84%E5%95%8F%E9%A1%8C" id="markdown-toc-polyfillが巨大すぎてスクリプトエディタ開かない問題">polyfillが巨大すぎてスクリプトエディタ開かない問題</a></li> <li><a href="#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E5%88%86%E5%89%B2%E3%81%99%E3%82%8B%E3%81%A8importexport%E4%BD%BF%E3%81%88%E3%81%AA%E3%81%84%E5%95%8F%E9%A1%8C" id="markdown-toc-ファイル分割するとimportexport使えない問題">ファイル分割するとimport/export使えない問題</a></li> </ul> </li> <li><a href="#%E6%88%91%E3%80%85%E3%81%AF%E3%81%A9%E3%81%86%E3%81%97%E3%81%A6%E3%81%84%E3%81%91%E3%81%B0%E3%82%88%E3%81%84%E3%81%AE%E3%81%8B" id="markdown-toc-我々はどうしていけばよいのか">我々はどうしていけばよいのか</a></li> <li><a href="#%E7%B5%82%E3%82%8F%E3%82%8A%E3%81%AB" id="markdown-toc-終わりに">終わりに</a></li> </ul> <h2 id="前回のおさらい">前回のおさらい</h2> <p>「<a href="/post/2018-12-03-1">Google Apps Scriptのモダンな開発環境を求めて</a>」では、スクリプトエディタ上でJavaScriptを記述していく一般的な方法ではなく、<a href="https://github.com/google/clasp" target="_blank" rel="noopener noreferrer">clasp</a>を使う方法を紹介しました。 claspはTypeScriptをサポートしていますが、ES Modulesをサポートしていないため、npmライブラリを使いたい場合は<a href="https://babeljs.io/" target="_blank" rel="noopener noreferrer">Babel</a>と<a href="https://webpack.js.org/" target="_blank" rel="noopener noreferrer">webpack</a>を組み合わせてビルドする必要がありました。</p> <p>ちなみに、<a href="https://github.com/kenchan0130/babel-preset-google-apps-script" target="_blank" rel="noopener noreferrer">babel-preset-google-apps-script</a>というプリセットを用意しましたので、Babelを使う場合ぜひご利用ください。</p> <h2 id="見えてきた課題">見えてきた課題</h2> <p>GASのモダンな開発環境を作りましたが、いくつかの課題が見えてきました。</p> <h3 id="npmライブラリが種類によってgasでは動かない問題">npmライブラリが種類によってGASでは動かない問題</h3> <p>理想を言うのであれば、もちろんどんなアプリケーションを作成したとしても、使用するライブラリがどのようなしくみで動作しているのかを理解するべきではあります。 やりたいことを高速に実現し、自分たちのアプリケーションに注力するためにライブラリを使用するという目的もあるため、実際問題として隅から隅まで実装を理解および把握するのは難しく、しばしば大まかな挙動のみの把握および理解するにとどまります。</p> <p>前回の記事では、車輪の再発明はつらいですし、せっかくnpmライブラリが使用できるなら使わない手はないと考え、npmライブラリを使用できる環境を構築しました。 しかし、GASプロジェクトでnpmライブラリを使用する際は、隅から隅までとは言いませんが、それでも普段のアプリケーション開発よりはnpmライブラリがどのように動作しているかを理解および把握する必要がでてきました。</p> <p>なぜなら、npmライブラリ内でGASがサポートしていないNode.jsのしくみが使われていると、当然ながらGASでは動作しないからです。</p> <p>たとえば、使用するライブラリの内部に<code class="language-plaintext highlighter-rouge">Promise</code>が使われていた場合、GASでは動作しないため実行時エラーになってしまいます。Babelを使用したとしても、<code class="language-plaintext highlighter-rouge">Promise</code>をトランスパイルできるわけではないため、<code class="language-plaintext highlighter-rouge">Promose</code>が使用されていないライブラリを探すか自身で実装する必要があります。</p> <p>ゆえに、もしnpmライブラリを使いたい場合は、使用するライブラリおよびその依存の数が少なく、それらの実装を理解および把握できる場合に限り使用をしてもよいと考えています。</p> <h3 id="polyfillが巨大すぎてスクリプトエディタ開かない問題">polyfillが巨大すぎてスクリプトエディタ開かない問題</h3> <p>npmライブラリは物によってはES6<sup id="fnref:ES6"><a href="#fn:ES6" class="footnote" rel="footnote" role="doc-noteref">1</a></sup>などで記述されており、そのままwebpackでバンドルしてしまうとGASでは動作しません。 GASで動作させるには、<a href="https://github.com/zloirock/core-js" target="_blank" rel="noopener noreferrer">core-js</a>などのpolyfillをインポートする必要があります。</p> <p>多くのしくみをES3相当までトランスパイルする必要があるため、minifyしたとしてもpolyfillでインポートするコードは数十から数百KBになります。 GASのスクリプトエディタはこのような巨大なファイルを開くのが苦手です。実際に開いてみるとコードが表示されてUIを操作できるまでに数十分を要します。</p> <p>claspを導入しているので、「CLIでやればWeb UIは必要ないじゃん」と思われるかもしれませんが、claspではWebアプリケーションのリリースはできてもデプロイはできません。<sup id="fnref:clasp-issue-63"><a href="#fn:clasp-issue-63" class="footnote" rel="footnote" role="doc-noteref">2</a></sup></p> <p>そのため、どうしてもスクリプトエディタを開くまたは対象の操作のHTTPリクエストを特定してリクエストを模倣する必要がでてきます。 また、各種スクリプトエディタでないと実現が難しい機能を使いたい場合にも、この副作用が開発に支障をきたす可能性もあります。</p> <h3 id="ファイル分割するとimportexport使えない問題">ファイル分割するとimport/export使えない問題</h3> <p>Babelやwebpackの力を借りずになるべくシンプルにやりたいことを実現したい。 そう思って、「claspで標準サポートされているTypeScriptのみで実現しよう」と思うこともあります。 そして、開発を進めていくとファイルを分割したくなります。</p> <p>以下のような2つのファイルがあるとします。</p> <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">someUseCase</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./someUseCase</span><span class="dl">'</span><span class="p">;</span>

<span class="kr">interface</span> <span class="nx">PostEvent</span> <span class="p">{</span>
  <span class="nl">queryString</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">parameters</span><span class="p">:</span> <span class="p">{</span> <span class="p">[</span><span class="na">index</span><span class="p">:</span> <span class="kr">string</span><span class="p">]:</span> <span class="p">[</span><span class="kr">string</span> <span class="o">|</span> <span class="kc">undefined</span><span class="p">]</span> <span class="p">};</span>
  <span class="nl">contentLength</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
  <span class="nl">contentPath</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kd">function</span> <span class="nf">doPost</span><span class="p">(</span>
  <span class="nx">event</span><span class="p">:</span> <span class="nx">PostEventFromSlack</span>
<span class="p">):</span> <span class="nx">GoogleAppsScript</span><span class="p">.</span><span class="nx">Content</span><span class="p">.</span><span class="nx">TextOutput</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">someUseCase</span><span class="p">.</span><span class="nf">run</span><span class="p">();</span>

  <span class="k">return</span> <span class="nx">ContentService</span><span class="p">.</span><span class="nf">createTextOutput</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nf">stringify</span><span class="p">(</span><span class="nx">response</span><span class="p">)).</span><span class="nf">setMimeType</span><span class="p">(</span><span class="nx">ContentService</span><span class="p">.</span><span class="nx">MimeType</span><span class="p">.</span><span class="nx">JSON</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div> <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">interface</span> <span class="nx">SomeUseCaseResponseDto</span> <span class="p">{</span>
  <span class="nl">test</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">SomeUseCase</span> <span class="p">{</span>
  <span class="k">public</span> <span class="nf">run</span><span class="p">():</span> <span class="nx">SomeUseCaseResponseDto</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="na">test</span><span class="p">:</span> <span class="dl">"</span><span class="s2">This is test response.</span><span class="dl">"</span>
    <span class="p">};</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">someUseCase</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SomeUseCase</span><span class="p">();</span>
</code></pre></div></div> <p>これを実際に<code class="language-plaintext highlighter-rouge">clasp push</code>しても<code class="language-plaintext highlighter-rouge">import</code>部がコメントアウトされるだけで、実際に実行すると</p> <blockquote> <p>ReferenceError: someUseCase is not defined</p> </blockquote> <p>となり、動作しないことがあります。 これはGAS側で複数ファイルある場合は独自に結合して実行をするため、実行順番が保証されずこのようなことが起こります。</p> <p>この問題に対応するには<a href="https://github.com/google/clasp/blob/master/docs/typescript.md#modules-exports-and-imports" target="_blank" rel="noopener noreferrer">公式</a>で以下の3つが提案されています。</p> <ol> <li> <code class="language-plaintext highlighter-rouge">exports</code>に値が入っているので<code class="language-plaintext highlighter-rouge">declare const exports</code>して<code class="language-plaintext highlighter-rouge">exports.xxx</code>として呼び出す</li> <li>TypeScriptの<code class="language-plaintext highlighter-rouge">namespace</code>を使用する</li> <li>webpackなどのサードパーティのビルドツールを使用する</li> </ol> <p>3つ目の方法はすでに紹介および実行した方法です。 1つ目を試してみましたが、動作が不安定でした。 2つ目の、</p> <blockquote> <p>TypeScriptの<code class="language-plaintext highlighter-rouge">namespace</code>を使用する</p> </blockquote> <p>は動作することは確認しています。具体的には前述の例は以下のようになります。</p> <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">SomeUseCase</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./SomeUseCase</span><span class="dl">'</span><span class="p">;</span>

<span class="kr">interface</span> <span class="nx">PostEvent</span> <span class="p">{</span>
  <span class="nl">queryString</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">parameters</span><span class="p">:</span> <span class="p">{</span> <span class="p">[</span><span class="na">index</span><span class="p">:</span> <span class="kr">string</span><span class="p">]:</span> <span class="p">[</span><span class="kr">string</span> <span class="o">|</span> <span class="kc">undefined</span><span class="p">]</span> <span class="p">};</span>
  <span class="nl">contentLength</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
  <span class="nl">contentPath</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kd">function</span> <span class="nf">doPost</span><span class="p">(</span>
  <span class="nx">event</span><span class="p">:</span> <span class="nx">PostEventFromSlack</span>
<span class="p">):</span> <span class="nx">GoogleAppsScript</span><span class="p">.</span><span class="nx">Content</span><span class="p">.</span><span class="nx">TextOutput</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">SomeUseCase</span><span class="p">.</span><span class="nf">run</span><span class="p">();</span>

  <span class="k">return</span> <span class="nx">ContentService</span><span class="p">.</span><span class="nf">createTextOutput</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nf">stringify</span><span class="p">(</span><span class="nx">response</span><span class="p">)).</span><span class="nf">setMimeType</span><span class="p">(</span><span class="nx">ContentService</span><span class="p">.</span><span class="nx">MimeType</span><span class="p">.</span><span class="nx">JSON</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div> <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">interface</span> <span class="nx">SomeUseCaseResponseDto</span> <span class="p">{</span>
  <span class="nl">test</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">namespace</span> <span class="nx">SomeUseCase</span> <span class="p">{</span>
  <span class="k">export</span> <span class="kd">function</span> <span class="nf">run</span><span class="p">():</span> <span class="nx">SomeUseCaseResponseDto</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="na">test</span><span class="p">:</span> <span class="dl">"</span><span class="s2">This is test response.</span><span class="dl">"</span>
    <span class="p">};</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>しかし、この方法はいくつかの不安要素を抱えています。</p> <ul> <li> <code class="language-plaintext highlighter-rouge">class</code>が使えないまたは使うにはテクニックがいる</li> <li> <code class="language-plaintext highlighter-rouge">namespace</code>はTypeScript界隈では使用しないほうが良いという流れ<sup id="fnref:is-typescript-namespace-feature-deprecated"><a href="#fn:is-typescript-namespace-feature-deprecated" class="footnote" rel="footnote" role="doc-noteref">3</a></sup>になっている</li> </ul> <p>これらの不安要素がある状態を認識したうえであれば、この手法を選択できると考えています。</p> <h2 id="我々はどうしていけばよいのか">我々はどうしていけばよいのか</h2> <p>たくさんの課題がある中で、我々はどのようにしてGASをモダンな開発していけばよいのでしょうか。 正直答えは持ち合わせていないですが、個人的には</p> <ul> <li>claspとTypeScriptで開発をする <ul> <li>コードはGitなどのバーション管理ツールで管理するため</li> <li>TypeScriptで型の恩恵をうけることにより、なるべく安全なアプリケーションを作成する</li> </ul> </li> <li>npmライブラリは使わない <ul> <li>使いたい場合はGASのライブラリを使用する <ul> <li> <a href="https://github.com/contributorpw/google-apps-script-awesome-list" target="_blank" rel="noopener noreferrer">google-apps-script-awesome-list</a>などで探す</li> </ul> </li> </ul> </li> <li>1ファイルを超えないようにする <ul> <li>超えるのであればGASとして運用すべきではない可能性が高い</li> </ul> </li> </ul> <p>と考えています。 つまり、GASでは無理をしないということです。</p> <h2 id="終わりに">終わりに</h2> <p>モダンな開発環境によってDeveloper Experienceが高いGASプロジェクトを開発できたわけではなく課題があり、その課題に対する対応方法を紹介しました。</p> <p>もう一点気になることとしては、中々Merge Requestがマージされない状況からclaspが最近開発が活発ではないという印象を受けています。 執筆時点では2019年9月25日を最後に更新されていません。</p> <p>このような状況を把握しつつGASの開発していくとよいでしょう。</p> <div class="footnotes" role="doc-endnotes"> <ol> <li id="fn:ES6"> <p>ECMAScript2015の略称であり、ES2015とも呼ばれ、Ecma Internationalによって<a href="https://www.ecma-international.org/publications-and-standards/standards/ecma-262/" target="_blank" rel="noopener noreferrer">標準化</a>されている <a href="#fnref:ES6" class="reversefootnote" role="doc-backlink">↩</a></p> </li> <li id="fn:clasp-issue-63"> <p>GASに該当するAPIがないため実現ができていない <a href="https://github.com/google/clasp/issues/63" target="_blank" rel="noopener noreferrer">Clasp deploy doesn’t update the deployed version with Google Apps Script Web App</a> <a href="#fnref:clasp-issue-63" class="reversefootnote" role="doc-backlink">↩</a></p> </li> <li id="fn:is-typescript-namespace-feature-deprecated"> <p><a href="https://michelenasti.com/2019/01/23/is-typescript-namespace-feature-deprecated.html" target="_blank" rel="noopener noreferrer">Is TypeScript Namespace feature deprecated?</a> <a href="#fnref:is-typescript-namespace-feature-deprecated" class="reversefootnote" role="doc-backlink">↩</a></p> </li> </ol> </div> </article> <section class="share"> <a href="//twitter.com/share?text=Google+Apps+Script%E3%81%AE%E3%83%A2%E3%83%80%E3%83%B3%E3%81%AA%E9%96%8B%E7%99%BA%E7%92%B0%E5%A2%83%E3%81%AF%E7%90%86%E6%83%B3%E3%81%A0%E3%81%A3%E3%81%9F&amp;url=https%3A%2F%2Fkenchan0130.github.io%2Fpost%2F2019-12-25-1%3Futm_source%3Dtwitter%26utm_medium%3Dsocial&amp;via=kenchan0130" onclick="window.open(this.href, 'twitter-share', 'width=550,height=255,menubar=no,toolbar=no,resizable=yes');return false;"> <i class="fab fa-twitter fa-lg"></i> </a> <a href="//www.facebook.com/sharer.php?t=Google+Apps+Script%E3%81%AE%E3%83%A2%E3%83%80%E3%83%B3%E3%81%AA%E9%96%8B%E7%99%BA%E7%92%B0%E5%A2%83%E3%81%AF%E7%90%86%E6%83%B3%E3%81%A0%E3%81%A3%E3%81%9F&amp;u=https%3A%2F%2Fkenchan0130.github.io%2Fpost%2F2019-12-25-1%3Futm_source%3Dfacebook%26utm_medium%3Dsocial" onclick="window.open(this.href, 'facebook-share', 'width=550,height=255,menubar=no,toolbar=no,resizable=yes');return false;"> <i class="fab fa-facebook fa-lg"></i> </a> <a href="//b.hatena.ne.jp/entry/panel/?btitle=Google+Apps+Script%E3%81%AE%E3%83%A2%E3%83%80%E3%83%B3%E3%81%AA%E9%96%8B%E7%99%BA%E7%92%B0%E5%A2%83%E3%81%AF%E7%90%86%E6%83%B3%E3%81%A0%E3%81%A3%E3%81%9F&amp;url=https%3A%2F%2Fkenchan0130.github.io%2Fpost%2F2019-12-25-1" onclick="window.open(this.href, 'hatena-share', 'width=550,height=600,menubar=no,toolbar=no,resizable=yes');return false;"> <i class="fab fa-hatena fa-lg"></i> </a> </section> <section class="post-donation"> <div class="post-donation-panel"> <p class="post-donation-description"> 参考になった・面白かったと感じていただけましたら、サポートいただけると励みになります。 </p> <a class="post-donation-button" href="https://www.buymeacoffee.com/kenchan0130" onclick="gtag('event', 'click-buymeacoffee', { event_category: 'www.buymeacoffee.com/kenchan0130', event_label: '/post/2019-12-25-1' });" target="_blank" rel="noopener noreferrer"> <p class="post-donation-button-body"> <img class="icon lazyload" alt="buymeacoffee" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="https://www.buymeacoffee.com/assets/img/BMC-btn-logo.svg"> <span class="label">サポートする</span> </p> </a> </div> </section> <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-2444060431947599" data-ad-slot="7319689305" data-ad-format="auto"></ins> <script>(adsbygoogle=window.adsbygoogle||[]).push({});</script> <section class="sub-contents related-posts"> <div class="sub-contents-wrapper"> <div class="sub-contents-title">あわせて読みたい</div> <div class="sub-contents-main"> <li> <a href="/post/2018-12-03-1">Google Apps Scriptのモダンな開発環境を求めて</a> <span class="post-date">- December 3, 2018</span> </li> <li> <a href="/post/2021-02-24-1">GitHub ActionsのRunner OSの情報を取得できるアクションを作った</a> <span class="post-date">- February 24, 2021</span> </li> <li> <a href="/post/2021-10-29-1">Designship 2021のライブ配信サイトの開発周りについて</a> <span class="post-date">- October 29, 2021</span> </li> <li> <a href="/post/2018-05-21-1">UserScriptで業務改善</a> <span class="post-date">- May 21, 2018</span> </li> <li> <a href="/post/2021-12-09-1">Next.jsでStatic GenerationしたサイトをAWSでホスティングする</a> <span class="post-date">- December 9, 2021</span> </li> </div> </div> </section> <section class="sub-contents tags"> <div class="sub-contents-wrapper"> <div class="sub-contents-title">Tags</div> <div class="sub-contents-main"> <a href="/tag/google-apps-script">Google Apps Script</a> <a href="/tag/javascript">JavaScript</a> <a href="/tag/typescript">TypeScript</a> <a href="/tag/clasp">clasp</a> <a href="/tag/node-js">Node.js</a> </div> </div> </section> </div> </div> </div> <footer class="site-footer"> <div class="wrapper"> <h3 class="footer-heading">kenchan0130 blog</h3> <div class="site-navigation"> <p><strong>Site Map</strong></p> <ul class="pages"> <li class="nav-link"> <a href="/archives">Archives</a> </li> <li class="nav-link"> <a href="/privacy">Privacy Policy</a> </li> <li class="nav-link"> <a href="/profile">Profile</a> </li> <li class="nav-link"> <a href="/profile/resume">Resume</a> </li> </ul> </div> <div class="site-contact"> <p><strong>Contact</strong></p> <ul class="social-media-list"> <li> <a href="https://twitter.com/kenchan0130" title="Follow me on Twitter" target="_blank" rel="noopener noreferrer"> <i class="fab fa-twitter"></i> <span class="username">kenchan0130</span> </a> </li> <li> <a href="https://github.com/kenchan0130" title="Fork me on GitHub" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> <span class="username">kenchan0130</span> </a> </li> </ul> </div> <div class="site-signature"> <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p> <p class="text">ソフトウェアエンジニア。記録に残したいことを雑に備忘するブログ。 投稿内容は個人の見解であり所属する組織の公式見解ではありません。 </p> </div> </div> <div class="licence">このサイトのコンテンツは<a href="https://creativecommons.org/licenses/by/4.0/deed.ja" target="_blank" rel="noopener noreferrer">Creative Commons Attribution 4.0 International (CC-BY-4.0) License</a>の下でライセンスされています。</div> <div class="copyright">Copyright © 2017-2025 Tadayuki Onishi All Rights Reserved.</div> </footer> <script src="/assets/bundle/app.55445db2fff8ddfed8c5.js" async></script> <script async src="//www.googletagmanager.com/gtag/js?id=G-B7RX34Q5PL"></script> <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-B7RX34Q5PL");</script> <script async src="//www.googletagmanager.com/gtag/js?id=UA-79827366-2"></script> <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-79827366-2");</script> </body> </html>